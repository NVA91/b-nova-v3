# üìÅ Samba Configuration - Generated by Ansible
# NOVA v3 - Samba Role

[global]
   workgroup = {{ samba_workgroup | default('WORKGROUP') }}
   server string = {{ samba_server_string | default('NOVA v3 Samba Server') }}
   
   # Security
   security = user
   encrypt passwords = yes
   passdb backend = tdbsam
   
   # Logging
   log file = /var/log/samba/log.%m
   max log size = 1000
   log level = {{ samba_log_level | default('1') }}
   
   # Performance
   socket options = TCP_NODELAY IPTOS_LOWDELAY SO_RCVBUF=131072 SO_SNDBUF=131072
   read raw = yes
   write raw = yes
   max xmit = 65535
   dead time = 15
   getwd cache = yes
   
   # Networking
   bind interfaces only = {{ samba_bind_interfaces_only | default('no') }}
{% if samba_interfaces is defined %}
   interfaces = {{ samba_interfaces | join(' ') }}
{% endif %}

{% for share in samba_shares %}
[{{ share.name }}]
   comment = {{ share.comment | default(share.name) }}
   path = {{ share.path }}
   browseable = {{ share.browseable | default('yes') }}
   writable = {{ share.writable | default('yes') }}
   guest ok = {{ share.guest_ok | default('no') }}
   valid users = {{ share.valid_users | default('@users') }}
   create mask = {{ share.create_mask | default('0664') }}
   directory mask = {{ share.directory_mask | default('0775') }}
{% if share.veto_files is defined %}
   veto files = {{ share.veto_files }}
{% endif %}

{% endfor %}
